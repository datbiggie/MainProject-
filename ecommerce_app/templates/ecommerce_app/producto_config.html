{% load static %}
<!DOCTYPE html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Vista Productos</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'producto_sucursal/images/favicon.svg' %}" />

    <!-- ========================= CSS here ========================= -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'producto_sucursal/css/LineIcons.3.0.css' %}" />
    <link rel="stylesheet" href="{% static 'producto_sucursal/css/animate.css' %}" />
    <link rel="stylesheet" href="{% static 'producto_sucursal/css/tiny-slider.css' %}" />
    <link rel="stylesheet" href="{% static 'producto_sucursal/css/glightbox.min.css' %}" />
    <link rel="stylesheet" href="{% static 'producto_sucursal/css/main.css' %}" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    
    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
   
</head>

<body>
    <!-- Variables globales para JavaScript -->
    <script>
        window.CSRF_TOKEN = '{{ csrf_token }}';
        window.DELETE_PRODUCT_URL = '{% url "eliminar_producto" %}';
    </script>
    
    <!-- Start Features Area -->
    <section class="features section">
        <div class="container">
            <div class="row">
                {% for producto_all in producto_sucursal_all %}
                <div class="col-lg-4 col-md-6 col-12 wow fadeInUp" data-wow-delay=".2s">
                    <!-- Start Single Feature -->
                    <div class="single-featuer">
                        <img class="shape" src="{% static 'producto_sucursal/images/features/shape.svg' %}" alt="#">
                        <img class="shape2" src="{% static 'producto_sucursal/images/features/shape2.svg' %}" alt="#">
                        <span class="serial">{{ forloop.counter }}</span>
                        <div class="service-icon">
                            <i class="lni lni-microphone"></i>
                        </div>
                        <h3>{{ producto_all.nombre_producto }}</h3>
                        <p>{{producto_all.descripcion_producto}}</p>
                        <div class="feature-buttons">
                            <button href="#EditProductModal" class="btn btn-edit" data-bs-toggle="modal" data-bs-target="#EditProductModal"
                                    data-id="{{ producto_all.id_producto }}"
                                    data-nombre="{{ producto_all.nombre_producto }}"
                                    data-marca="{{ producto_all.marca_producto|default:'' }}"
                                    data-modelo="{{ producto_all.modelo_producto|default:'' }}"
                                    data-categoria="{{ producto_all.id_categoria_prod_fk.nombre_categoria_prod|default:'' }}"
                                    data-estatus="{{ producto_all.estatus_producto|default:'' }}"
                                    data-descripcion="{{ producto_all.descripcion_producto|default:'' }}"
                                    data-caracteristicas="{{ producto_all.caracteristicas_generales|default:'' }}"
                                    data-imagen="{{ producto_all.imagen_producto.url|default:'' }}">
                                <i class="lni lni-pencil"></i> Editar
                            </button>
                            <button class="btn btn-delete" data-id="{{ producto_all.id_producto }}" data-nombre="{{ producto_all.nombre_producto }}">
                                <i class="lni lni-trash"></i> Eliminar
                            </button>
                        </div>
                    </div>
                    <!-- End Single Feature -->
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    <!-- /End Features Area -->

    <!-- Modal de Edición de Producto ------->
    <div id="EditProductModal" class="modal fade">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <form method="POST" action="{% url 'editar_producto' %}" id="editProductoForm" enctype="multipart/form-data" onsubmit="return false;">
                    {% csrf_token %}
                    <input type="hidden" name="id_producto" id="edit_id_producto">
                    <div class="modal-header">
                        <h4 class="modal-title">Editar Producto</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Nombre del Producto</label>
                                    <input type="text" class="form-control" name="nombre_producto" id="edit_nombre" required>
                                </div>
                                <div class="form-group">
                                    <label>Marca</label>
                                    <input type="text" class="form-control" name="marca_producto" id="edit_marca">
                                </div>
                                <div class="form-group">
                                    <label>Modelo</label>
                                    <input type="text" class="form-control" name="modelo_producto" id="edit_modelo">
                                </div>
                                <div class="form-group">
                                    <label>Categoría</label>
                                    <select class="form-control" name="categoria_producto" id="edit_categoria" required>
                                        <option value="">Seleccione una categoría</option>
                                        {% for categoria in categoria_producto_all  %}
                                            <option value="{{ categoria.id_categoria_prod }}">{{ categoria.nombre_categoria_prod }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Estatus</label>
                                    <select class="form-control" name="estatus_producto" id="edit_estatus" required>
                                        <option value="">Seleccione un estatus</option>
                                        <option value="activo">Activo</option>
                                        <option value="inactivo">Inactivo</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Descripción</label>
                                    <textarea class="form-control" name="descripcion_producto" id="edit_descripcion" style="height: 80px;"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Características Generales</label>
                                    <textarea class="form-control" name="caracteristicas_generales" id="edit_caracteristicas" style="height: 80px;" required></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Imagen</label>
                                    <div class="file-upload-wrapper" style="max-width: 200px;">
                                        <div class="file-upload-container">
                                            <input type="file" name="imagen_producto" id="edit_imagen_producto" class="form-control file-input" accept="image/*">
                                            <div class="file-upload-placeholder">
                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="#536387" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                    <path d="M17 8L12 3L7 8" stroke="#536387" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                    <path d="M12 3V15" stroke="#536387" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                </svg>
                                                <span>Seleccionar imagen</span>
                                            </div>
                                            <div class="image-preview" id="edit_imagePreview"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ========================= JS here ========================= -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'producto_sucursal/js/wow.min.js' %}"></script>
    <script src="{% static 'producto_sucursal/js/tiny-slider.js' %}"></script>
    <script src="{% static 'producto_sucursal/js/glightbox.min.js' %}"></script>
    <script src="{% static 'producto_sucursal/js/count-up.min.js' %}"></script>
    <script src="{% static 'producto_sucursal/js/main.js' %}"></script>
    <script src="{% static 'producto_sucursal/js/producto_config.js' %}"></script>
</body>

</html>